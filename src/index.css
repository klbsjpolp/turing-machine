@import url('https://fonts.googleapis.com/css2?family=IM+Fell+English:ital@0;1&family=Cinzel+Decorative:wght@400;700;900&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 45 20% 90%; /* steampunk-steam */
    --foreground: 220 13% 18%; /* steampunk-coal */

    --card: 30 25% 35%; /* steampunk-bronze */
    --card-foreground: 45 20% 90%; /* steampunk-steam */

    --popover: 30 25% 25%; /* steampunk-darkBronze */
    --popover-foreground: 45 20% 90%; /* steampunk-steam */

    --primary: 25 50% 50%; /* steampunk-copper */
    --primary-foreground: 45 20% 90%; /* steampunk-steam */

    --secondary: 45 50% 55%; /* steampunk-brass */
    --secondary-foreground: 220 13% 18%; /* steampunk-coal */

    --muted: 30 25% 35%; /* steampunk-bronze */
    --muted-foreground: 45 20% 80%; /* Mechanical Digit Selector */

    --accent: 50 70% 60%; /* steampunk-gold */
    --accent-foreground: 220 13% 18%; /* steampunk-coal */

    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;

    --border: 30 25% 25%; /* steampunk-darkBronze */
    --input: 30 25% 45%; /* lighter bronze */
    --ring: 50 70% 60%; /* steampunk-gold */

    --radius: 0.2rem;

    --sidebar-background: 220 13% 18%; /* steampunk-coal */
    --sidebar-foreground: 45 20% 90%; /* steampunk-steam */
    --sidebar-primary: 50 70% 60%; /* steampunk-gold */
    --sidebar-primary-foreground: 220 13% 18%; /* steampunk-coal */
    --sidebar-accent: 30 25% 25%; /* steampunk-darkBronze */
    --sidebar-accent-foreground: 45 20% 90%; /* steampunk-steam */
    --sidebar-border: 30 25% 35%; /* steampunk-bronze */
    --sidebar-ring: 50 70% 60%; /* steampunk-gold */
  }

  .dark {
    --background: 220 13% 18%; /* steampunk-coal */
    --foreground: 45 20% 90%; /* steampunk-steam */

    --card: 30 25% 25%; /* steampunk-darkBronze */
    --card-foreground: 45 20% 90%; /* steampunk-steam */

    --popover: 220 13% 10%; /* darker coal */
    --popover-foreground: 45 20% 90%; /* steampunk-steam */

    --primary: 50 70% 60%; /* steampunk-gold */
    --primary-foreground: 220 13% 18%; /* steampunk-coal */

    --secondary: 30 25% 35%; /* steampunk-bronze */
    --secondary-foreground: 45 20% 90%; /* steampunk-steam */

    --muted: 30 25% 25%; /* steampunk-darkBronze */
    --muted-foreground: 45 20% 70%; /* dimmer steam */

    --accent: 25 50% 50%; /* steampunk-copper */
    --accent-foreground: 45 20% 90%; /* steampunk-steam */

    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;

    --border: 30 25% 35%; /* steampunk-bronze */
    --input: 30 25% 25%; /* steampunk-darkBronze */
    --ring: 25 50% 50%; /* steampunk-copper */
    --sidebar-background: 220 13% 10%; /* darker coal */
    --sidebar-foreground: 45 20% 80%; /* dimmer steam */
    --sidebar-primary: 50 70% 60%; /* steampunk-gold */
    --sidebar-primary-foreground: 220 13% 18%; /* steampunk-coal */
    --sidebar-accent: 30 25% 25%; /* steampunk-darkBronze */
    --sidebar-accent-foreground: 45 20% 90%; /* steampunk-steam */
    --sidebar-border: 30 25% 35%; /* steampunk-bronze */
    --sidebar-ring: 50 70% 60%; /* steampunk-gold */
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground font-['IM_Fell_English'] 
           bg-[url('https://www.transparenttextures.com/patterns/textured-paper.png')];
  }

  h1, h2, h3, h4, h5, h6 {
    @apply font-['Cinzel_Decorative'];
  }

  .pressable:not(:disabled) {
    @apply transition-transform duration-100;
  }
  .pressable:not(:disabled):hover {
    @apply brightness-110;
  }
  .pressable:not(:disabled):active {
    transform: translateY(2px);
    @apply brightness-95;
  }

  .rivet {
    @apply absolute w-3 h-3 rounded-full z-20 bg-[radial-gradient(circle_at_30%_30%,hsl(45_50%_55%),hsl(30_25%_25%))] shadow-[1px_1px_2px_black];
  }

  /* Digit Selector with Rails */
  .digit-selector {
    @apply relative w-10 h-20 mx-1 p-0 bg-transparent border-none cursor-pointer 
           flex flex-col items-center justify-start outline-none;
  }

  .digit-selector .digit-value {
    @apply w-10 h-10 flex items-center justify-center text-2xl font-mono font-bold 
           text-amber-900 bg-amber-900/10 rounded-full transition-all duration-300 
           ease-in-out relative z-10 border-2 border-amber-900/30 translate-y-0;
  }

  .digit-selector .digit-rail {
    @apply absolute top-0 left-1/2 -translate-x-1/2 w-1 h-full 
           bg-amber-900/10 rounded overflow-hidden z-0;
  }


  .digit-selector .digit-rail::after {
    @apply content-[''] absolute top-0 left-0 right-0 h-full 
           bg-amber-900/40 -translate-y-full transition-transform 
           duration-300 ease-in-out;
  }

  .digit-selector.selected .digit-value {
    @apply text-amber-50 bg-amber-900/80 shadow-[0_0_10px_rgba(180,83,9,0.5)] 
           border-amber-50/50 translate-y-0;
  }

  .digit-selector:not(.selected) .digit-value {
    @apply translate-y-6 opacity-80;
  }

  .digit-selector:not(.selected) .digit-rail::after {
    @apply translate-y-0;
  }

  .digit-selector.selected .digit-rail::after {
    @apply translate-y-0;
  }

  .digit-selector.animating {
    transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .digit-selector:disabled {
    cursor: not-allowed;
    opacity: 0.5;
  }

  .digit-selector:disabled .digit-value {
    background: rgba(100, 100, 100, 0.1);
    border-color: rgba(100, 100, 100, 0.2);
    color: #6b7280;
    box-shadow: none;
  }

  .digit-selector:disabled .digit-rail {
    background: rgba(100, 100, 100, 0.05);
  }

  .digit-selector:disabled .digit-rail::after {
    background: rgba(100, 100, 100, 0.15);
  }

  .control-button {
    @apply w-12 h-12 flex items-center justify-center rounded-md border-2 
           bg-gradient-to-b from-steampunk-bronze to-steampunk-darkBronze 
           transition-all duration-100 border-steampunk-darkBronze 
           text-steampunk-steam shadow-[0_4px_0_0] shadow-steampunk-darkBronze;
  }

  .control-button:hover {
    @apply brightness-110;
  }

  .control-button:active {
    @apply shadow-[0_2px_0_0] shadow-steampunk-darkBronze translate-y-0.5;
  }

  .chimney {
    @apply absolute w-12 h-20 bg-gradient-to-b from-steampunk-darkBronze to-steampunk-coal border-x-2 border-b-2 border-steampunk-bronze rounded-t-sm z-0;
    top: -80px;
    left: 20%;
  }
  .chimney::before {
    content: '';
    @apply absolute -top-3 left-1/2 -translate-x-1/2 w-16 h-3 bg-steampunk-bronze rounded-sm;
  }

  .smoke {
    @apply absolute bottom-0 left-1/2 w-10 h-10 bg-steampunk-steam/30 rounded-full;
    transform: translateX(-50%);
    animation: smoke-rise 5s infinite linear;
  }
  .smoke:nth-child(2) {
    animation-delay: 1.7s;
    transform: translateX(-50%) scale(0.8);
  }
  .smoke:nth-child(3) {
    animation-delay: 3.2s;
    transform: translateX(-50%) scale(0.9);
  }

  .decorative-pipe {
    @apply absolute bg-gradient-to-r from-steampunk-copper to-steampunk-brass rounded-full shadow-md z-0;
  }
  .pipe-1 {
    @apply w-48 h-5 top-24 -left-16 -rotate-45;
  }
  .pipe-2 {
    @apply w-48 h-5 top-24 -right-16 rotate-45;
  }

  .paper-panel {
    @apply p-4 rounded-sm;
    background-color: #f5e8c8; /* Aged paper color */
    border: 1px solid #d3c4a4;
    color: #5a3d33;
    font-family: 'Courier New', Courier, monospace;
    box-shadow: 2px 2px 4px rgba(0,0,0,0.2);
  }

  .paper-panel-title {
    @apply text-2xl font-bold text-amber-900/80 mb-4 text-center border-b-2 border-dashed border-amber-800/30 pb-2;
    font-family: 'Cinzel Decorative', serif;
  }

  .ink-button {
    @apply w-full h-12 rounded-sm border-2 transition-all duration-150 font-bold text-lg;
    border-color: #5a3d33;
    color: #5a3d33;
    background-color: transparent;
    box-shadow: 0 3px #5a3d33;
  }

  .ink-button:hover {
    background-color: rgba(90, 61, 51, 0.1);
  }

  .ink-button:active {
    transform: translateY(2px);
    box-shadow: 0 1px #5a3d33;
  }

  .ink-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    box-shadow: 0 3px #5a3d33;
    transform: translateY(0);
  }

  .ink-button.destructive {
    border-color: #991b1b;
    color: #991b1b;
    box-shadow: 0 3px #991b1b;
  }

  .ink-button.destructive:hover {
    background-color: rgba(153, 27, 27, 0.1);
  }

  .ink-button.destructive:active {
    box-shadow: 0 1px #991b1b;
  }

  .history-entry {
    @apply p-2 rounded-sm border;
    border-color: #d3c4a4;
    background-color: #fcf3d9; /* Slightly lighter paper */
  }

  .punch-card {
    @apply cursor-pointer p-3 rounded-sm transition-all duration-200 flex flex-col gap-2;
    background-color: #f5e8c8; /* Aged paper color */
    border: 1px solid #d3c4a4;
    color: #5a3d33;
    font-family: 'Courier New', Courier, monospace;
    box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);

    &:hover {
      @apply bg-[#fcf3d9] border-[#d3c4a4];
    }

    &.analyzing {
      @apply relative overflow-hidden animate-[insert-card_0.8s_ease-out_forwards] origin-bottom;

      &::after {
        @apply content-[''] absolute top-0 -left-full w-full h-full animate-[shine_1.5s_infinite];
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      }
    }

    .punch-card-header {
      @apply flex justify-between items-center border-b-2 border-dashed border-amber-800/30 pb-2;
    }

    .punch-card-body {
      @apply flex-grow space-y-1;
    }

    .punch-row {
      @apply flex items-center gap-2 text-sm;

      & > span {
        @apply font-bold text-amber-900;
      }
    }

    .punch-divider {
      @apply flex items-center justify-center gap-2 text-xs text-amber-900/60;
    }

    .punch-card-footer {
      @apply flex justify-around items-center border-t-2 border-dashed border-amber-800/30 pt-2 mt-1;
    }

    .hole {
      @apply w-3 h-3 rounded-full bg-amber-900/20 relative transition-all duration-300 ease-in-out;
      box-shadow: inset 0 0 0 0 rgba(0, 0, 0, 0);
    }

    &.used .hole {
      background: radial-gradient(circle at 30% 30%, transparent 40%, rgba(0, 0, 0, 0.1) 100%);
      box-shadow: inset 0 0 8px 1px rgba(0, 0, 0, 0.3);
      transform: scale(0.8);

      @apply nth-1:bg-white
    }
  }
}

/* Animations */
@keyframes gear-rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

@keyframes nixie-glow {
  0%, 100% { text-shadow: 0 0 5px theme('colors.steampunk.gold','pink'), 0 0 10px theme('colors.steampunk.gold','pink'); }
  50% { text-shadow: 0 0 10px theme('colors.steampunk.gold','pink'), 0 0 20px theme('colors.steampunk.gold','pink'); }
}

@keyframes lever-pull {
  0% { transform: translateY(0) rotate(0); }
  50% { transform: translateY(2px) rotate(-1deg); }
  100% { transform: translateY(0) rotate(0); }
}

@keyframes steam-drift {
  from { transform: translateY(0); opacity: 0.5; }
  to { transform: translateY(-100px) translateX(20px); opacity: 0; }
}

@keyframes smoke-rise {
  0% {
    bottom: 0;
    opacity: 1;
    transform: translateX(-50%) scale(1);
  }
  100% {
    bottom: 150px;
    opacity: 0;
    transform: translateX(-30px) scale(3);
  }
}

@keyframes button-glow {
  from {
    --glow-color: theme('colors.steampunk.gold','pink');
    box-shadow: 0 0 15px 5px hsla(var(--glow-color), 0.7);
  }
  to {
    --glow-color: theme('colors.steampunk.gold','pink');
    box-shadow: 0 0 0 0 hsla(var(--glow-color), 0);
  }
}

@keyframes panel-shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-2px); }
  50% { transform: translateX(2px); }
  75% { transform: translateX(-2px); }
}

@keyframes flash-success {
  0%, 100% { opacity: 0; }
  50% { opacity: 0.3; }
}

@keyframes flash-failure {
  0%, 100% { opacity: 0; }
  50% { opacity: 0.4; }
}

@keyframes glow-victory {
  0% { opacity: 0; box-shadow: 0 0 50px 30px theme('colors.steampunk.gold','pink'); }
  50% { opacity: 0.5; box-shadow: 0 0 150px 80px theme('colors.steampunk.gold','pink'); }
  100% { opacity: 0; box-shadow: 0 0 50px 30px theme('colors.steampunk.gold','pink'); }
}

@keyframes flicker-defeat {
  0%, 100% { opacity: 0.3; }
  25% { opacity: 0.2; }
  50% { opacity: 0.4; }
  75% { opacity: 0.25; }
}

@keyframes dim-pulse {
  0%, 100% { opacity: 0; }
  50% { opacity: 0.2; }
}

@keyframes insert-card {
  0% {
    transform: translateY(0) rotate(0);
    opacity: 1;
  }
  40% {
    transform: translateY(-20px) rotate(-3deg) scale(1.05);
    opacity: 1;
  }
  100% {
    transform: translateY(80px) rotate(5deg) scale(0.8);
    opacity: 0;
  }
}

.animate-insert-card {
  animation: insert-card 0.8s ease-out forwards;
  transform-origin: center bottom;
}

.animate-gear-rotate {
  animation: gear-rotate 20s linear infinite;
}

.animate-nixie-glow {
  animation: nixie-glow 1.5s ease-in-out infinite;
}

.animate-lever-pull {
  animation: lever-pull 0.8s ease-in-out;
}

.animate-panel-shake {
  animation: panel-shake 0.3s ease-in-out;
}

.animate-flash-success {
  animation: flash-success 0.8s ease-out;
}

.animate-flash-failure {
  animation: flash-failure 0.8s ease-out;
}

.animate-glow-victory {
  animation: glow-victory 2.5s ease-in-out;
}

.animate-flicker-defeat {
  animation: flicker-defeat 1s linear infinite;
}

.animate-dim-pulse {
  animation: dim-pulse 1.5s ease-in-out;
}